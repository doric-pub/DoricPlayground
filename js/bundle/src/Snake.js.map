{"version":3,"file":"Snake.js","sources":["../../build/src/Snake.js"],"sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { text, loge, log, ViewHolder, Stack, ViewModel, Gravity, Color, VMPanel, LayoutSpec, vlayout, hlayout, takeNonNull } from \"doric\";\nvar Direction;\n(function (Direction) {\n    Direction[Direction[\"left\"] = 0] = \"left\";\n    Direction[Direction[\"right\"] = 1] = \"right\";\n    Direction[Direction[\"up\"] = 2] = \"up\";\n    Direction[Direction[\"down\"] = 3] = \"down\";\n})(Direction || (Direction = {}));\nvar State;\n(function (State) {\n    State[State[\"idel\"] = 0] = \"idel\";\n    State[State[\"run\"] = 1] = \"run\";\n    State[State[\"fail\"] = 2] = \"fail\";\n})(State || (State = {}));\nclass SnakeModel {\n    constructor(w, h) {\n        this.state = State.idel;\n        this.direction = Direction.right;\n        this.food = { x: -1, y: -1 };\n        this.head = {\n            x: 0,\n            y: 0,\n        };\n        this.width = w;\n        this.height = h;\n    }\n    refreshFood() {\n        this.food.x = Math.floor(Math.random() * (this.width - 1));\n        this.food.y = Math.floor(Math.random() * (this.height - 1));\n    }\n    get tail() {\n        let node = this.head;\n        while (node.next !== undefined) {\n            node = node.next;\n        }\n        return node;\n    }\n    get score() {\n        let node = this.head;\n        let n = 0;\n        while (node.next !== undefined) {\n            n++;\n            node = node.next;\n        }\n        return n;\n    }\n    forward(node) {\n        switch (this.direction) {\n            case Direction.left:\n                node.x -= 1;\n                break;\n            case Direction.right:\n                node.x += 1;\n                break;\n            case Direction.up:\n                node.y -= 1;\n                break;\n            case Direction.down:\n                node.y += 1;\n                break;\n        }\n    }\n    step() {\n        if (this.state !== State.run) {\n            return;\n        }\n        let tail = this.tail;\n        while (tail.prev != undefined) {\n            tail.x = tail.prev.x;\n            tail.y = tail.prev.y;\n            tail = tail.prev;\n        }\n        this.forward(this.head);\n        if (this.head.x < 0 || this.head.x >= this.width\n            || this.head.y < 0 || this.head.y >= this.height) {\n            //If out of bound\n            loge('out of bound');\n            this.state = State.fail;\n        }\n        else if (this.head.x == this.food.x && this.head.y == this.food.y) {\n            //If eat food\n            let head = { x: this.food.x, y: this.food.y };\n            log('eat food', head);\n            this.forward(head);\n            this.head.prev = head;\n            head.next = this.head;\n            this.head = head;\n            this.refreshFood();\n        }\n        if (this.crashAtSelf()) {\n            //If crash at self\n            loge('crash at self');\n            this.state = State.fail;\n        }\n    }\n    crashAtSelf() {\n        let cur = this.head.next;\n        while (cur !== undefined) {\n            if (cur.x == this.head.x && cur.y == this.head.y) {\n                return true;\n            }\n            cur = cur.next;\n        }\n        return false;\n    }\n    reset() {\n        this.direction = Direction.right;\n        this.state = State.run;\n        this.head.x = 0;\n        this.head.y = 0;\n        this.head.next = undefined;\n        this.refreshFood();\n    }\n}\nclass SnakeView extends ViewHolder {\n    build(root) {\n        root.backgroundColor = Color.parse('#000000');\n        vlayout([\n            text({\n                text: \"Snake\",\n                textSize: 20,\n                textColor: Color.parse(\"#ffffff\"),\n                layoutConfig: {\n                    alignment: new Gravity().centerX(),\n                    margin: {\n                        top: 20\n                    },\n                    widthSpec: LayoutSpec.FIT,\n                    heightSpec: LayoutSpec.FIT,\n                },\n            }),\n            (new Stack).also(panel => {\n                panel.backgroundColor = Color.parse('#00ff00');\n                this.panel = panel;\n            }),\n            hlayout([\n                text({\n                    text: \"Start\",\n                    textSize: 30,\n                    textColor: Color.parse(\"#ffffff\"),\n                    layoutConfig: {\n                        widthSpec: LayoutSpec.FIT,\n                        heightSpec: LayoutSpec.FIT,\n                    },\n                }).also(it => this.start = it),\n            ]).also(it => {\n                it.layoutConfig = {\n                    widthSpec: LayoutSpec.FIT,\n                    heightSpec: LayoutSpec.FIT,\n                };\n            }),\n            vlayout([\n                hlayout([\n                    text({\n                        width: 50,\n                        height: 50,\n                        text: \"↑\",\n                        textSize: 30,\n                        textAlignment: new Gravity().center(),\n                        backgroundColor: Color.parse('#ffff00'),\n                        layoutConfig: {\n                            widthSpec: LayoutSpec.JUST,\n                            heightSpec: LayoutSpec.JUST,\n                        },\n                    }).also(it => this.up = it)\n                ]).also(it => {\n                    it.layoutConfig = {\n                        widthSpec: LayoutSpec.FIT,\n                        heightSpec: LayoutSpec.FIT,\n                    };\n                }),\n                hlayout([\n                    text({\n                        width: 50,\n                        height: 50,\n                        text: \"←\",\n                        textSize: 30,\n                        textAlignment: new Gravity().center(),\n                        backgroundColor: Color.parse('#ffff00'),\n                        layoutConfig: {\n                            widthSpec: LayoutSpec.JUST,\n                            heightSpec: LayoutSpec.JUST,\n                        },\n                    }).also(it => this.left = it),\n                    text({\n                        width: 50,\n                        height: 50,\n                        text: \"↓\",\n                        textSize: 30,\n                        textAlignment: new Gravity().center(),\n                        backgroundColor: Color.parse('#ffff00'),\n                        layoutConfig: {\n                            widthSpec: LayoutSpec.JUST,\n                            heightSpec: LayoutSpec.JUST,\n                        },\n                    }).also(it => this.down = it),\n                    text({\n                        width: 50,\n                        height: 50,\n                        text: \"→\",\n                        textSize: 30,\n                        textAlignment: new Gravity().center(),\n                        backgroundColor: Color.parse('#ffff00'),\n                        layoutConfig: {\n                            widthSpec: LayoutSpec.JUST,\n                            heightSpec: LayoutSpec.JUST,\n                        },\n                    }).also(it => this.right = it),\n                ]).also(it => {\n                    it.layoutConfig = {\n                        widthSpec: LayoutSpec.FIT,\n                        heightSpec: LayoutSpec.FIT,\n                    };\n                    it.space = 10;\n                }),\n            ]).also(controlArea => {\n                controlArea.gravity = new Gravity().centerX();\n                controlArea.space = 10;\n                controlArea.layoutConfig = {\n                    alignment: new Gravity().centerX(),\n                    widthSpec: LayoutSpec.FIT,\n                    heightSpec: LayoutSpec.FIT,\n                };\n            }),\n        ]).also(it => {\n            it.space = 20;\n            it.layoutConfig = {\n                alignment: new Gravity().centerX().top(),\n                widthSpec: LayoutSpec.MOST,\n                heightSpec: LayoutSpec.MOST,\n            };\n            it.gravity = new Gravity().centerX();\n        }).in(root);\n    }\n    bind(state) {\n        log('build', state);\n        this.panel.width = state.width * 10;\n        this.panel.height = state.height * 10;\n        let node = state.head;\n        let nodes = [];\n        while (node != undefined) {\n            nodes.push(node);\n            node = node.next;\n        }\n        nodes.push(state.food);\n        nodes.forEach((e, index) => {\n            let item = this.panel.children[index];\n            if (item === undefined) {\n                item = new Stack;\n                item.width = item.height = 10;\n                item.corners = 5;\n                item.shadow = {\n                    color: Color.GRAY,\n                    opacity: 1,\n                    radius: 3,\n                    offsetX: 3,\n                    offsetY: 3,\n                };\n                this.panel.addChild(item);\n            }\n            if (index === nodes.length - 1) {\n                item.backgroundColor = Color.parse('#ffff00');\n            }\n            else {\n                item.backgroundColor = Color.parse('#ff0000');\n            }\n            item.x = e.x * 10;\n            item.y = e.y * 10;\n        });\n        if (nodes.length < this.panel.children.length) {\n            this.panel.children.length = nodes.length;\n        }\n    }\n}\nclass SnakeVM extends ViewModel {\n    constructor() {\n        super(...arguments);\n        this.start = () => {\n            if (this.timerId !== undefined) {\n                clearInterval(this.timerId);\n            }\n            this.updateState(it => it.reset());\n            this.timerId = setInterval(() => {\n                this.updateState(it => it.step());\n                if (this.getState().state === State.fail) {\n                    loge('Game Over');\n                    this.stop();\n                }\n            }, 500);\n        };\n        this.stop = () => {\n            if (this.timerId !== undefined) {\n                clearInterval(this.timerId);\n                this.timerId = undefined;\n            }\n        };\n        this.left = () => {\n            this.updateState(it => it.direction = Direction.left);\n        };\n        this.right = () => {\n            this.updateState(it => it.direction = Direction.right);\n        };\n        this.up = () => {\n            this.updateState(it => it.direction = Direction.up);\n        };\n        this.down = () => {\n            this.updateState(it => it.direction = Direction.down);\n        };\n    }\n    onAttached(state, v) {\n        takeNonNull(v.start)(it => it.onClick = this.start);\n        takeNonNull(v.left)(it => it.onClick = this.left);\n        takeNonNull(v.right)(it => it.onClick = this.right);\n        takeNonNull(v.up)(it => it.onClick = this.up);\n        takeNonNull(v.down)(it => it.onClick = this.down);\n    }\n    onBind(state, v) {\n        v.bind(state);\n    }\n}\nlet SnakePanel = class SnakePanel extends VMPanel {\n    getViewModelClass() {\n        return SnakeVM;\n    }\n    getState() {\n        return new SnakeModel(35, 35);\n    }\n    getViewHolderClass() {\n        return SnakeView;\n    }\n};\nSnakePanel = __decorate([\n    Entry\n], SnakePanel);\n//# sourceMappingURL=Snake.js.map"],"names":["this","loge","log","ViewHolder","Color","vlayout","text","Gravity","LayoutSpec","Stack","hlayout","ViewModel","takeNonNull","VMPanel"],"mappings":"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"}